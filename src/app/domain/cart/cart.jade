state-bar(
title='Заказ'
)
  div(layout='row')
    md-button.md-button.pink-button.md-raised(
    ng-if='vm.data.length'
    ui-sref='checkout'
    ) Оформить заказ

.cart.scroll-y(resize='cart' ng-style='{height: (cart.windowHeight - cart.offsetTop - 61)+"px"}')


  .height-100(
  ng-if='!vm.data.length'
  layout='column'
  layout-align='center center'
  )
    //.flex
    .emptyCart.md-whiteframe-1dp(ng-if='!vm.data.length')
      div(style='text-align: center') Корзина пуста
      div
        md-button.md-raised.pink-button(ui-sref='catalogue')
          | Перейти в Каталог
    //.flex

  md-table-container(ng-if='vm.data.length')
    table(md-table)
      thead(md-head)
        tr(md-row)
          th.hide-xs(md-column) Фото
          th(md-column) Наименование
          th(md-column) Количество
          th.hide-xs.hide-sm(md-column) Цена без скидки
          th.hide-xs.hide-sm(md-column) Скидка
          th(md-column) Цена со скидкой
          th.hide-xs(md-column) Стоимость
          th.hide-xs(md-column) Удалить
      tbody(md-body)
        tr(
        vr-animate-remove
        ar-watch='item.count'
        on-animate-end="vm.itemRemove(item)"
        md-row
        md-on-select='logItem'
        ng-repeat='item in vm.data track by item.id'
        )
          td.hide-xs.clickable(md-cell ng-click='vm.itemClick(item)')
            img.thumbnail(ng-src='{{item.article.activePhoto()}}')
          td.clickable.name(md-cell ng-click='vm.itemClick(item)') {{item.article.name}}
          td(md-cell)
            .plus-minus(layout-align='center center' layout='row')
              md-button.micro-fab(ng-click='vm.minusOne(item)') -
              md-input-container
                input(aria-label="Количество" ng-model="item.count" type="number" ng-change="vm.saveItem(item)" min='1' step='1')
              md-button.micro-fab(ng-click='vm.plusOne(item)') +
          td.hide-xs.hide-sm(md-cell) {{ item.article.highPrice | number: 2 }}&nbsp;₽
          td.hide-xs.hide-sm(md-cell) {{ (1 - item.article.discountedPrice(vm.cartSubTotal) / item.article.highPrice) * 100 | number: 1}}%
          td(md-cell) {{ item.article.discountedPrice(vm.cartSubTotal) | number: 2}}&nbsp;₽
          td.hide-xs(md-cell) {{ item.cost(vm.cartSubTotal) | number: 2}}&nbsp;₽
          td.hide-xs(md-cell)
            md-button.md-mini.md-icon-button(ng-click='vm.clearItem(item)' class="slide")
              i.material-icons.clear-icon-size clear

.footer.cart(layout='row' layout-align='center center')
  md-button.md-button.md-fab.md-mini.md-icon-button.default-button(
  ng-if='vm.data.length'
  ng-click='vm.clearCart($event)'
  )
    i.material-icons remove_shopping_cart
  span(flex)
  div(layout='column')
    p.no-margin.text-right
      span Итого к оплате:
      = ' '
      span.bold(style='min-width: 120px; display: inline-block; text-align: left;')
        | {{vm.cartTotal | number: 2}}&nbsp;₽
    p.no-margin.text-right
      span Cкидка {{ vm.cartDiscount | number: 1 }}%:
      = ' '
      span.bold(style='min-width: 120px; display: inline-block; text-align: left;')
        | {{vm.cartSubTotal - vm.cartTotal | number:2}}&nbsp;₽
